%% Initialization
clear;close all;clc;tic;

VERT = {[2],[1,4],[4,3],[5],[2],[5],[1,1,1],[1,1,1],[1,1],[1]};
HOR = {[1,3],[2,1,1],[1,3],[2,1,1],[2,2],[6,1],[4],[2],[1],[1]};

M = [ 0  0  0  -1 -1 -1 0  0  0  0;
      0  0  0  0  -1 0  0  -1 -1 0;
      0  0  0  0  -1 0  0  0  0  0;
      0  0  0  0  -1 0  0  -1 0  0;
      0  0  0  0  0  0  0  0  0  0;
      0  0  0  0  0  0  0  0  0  0;
      0  0  0  0  0  0  0  0  0  0;
      -1 0  0  0  -1 -1 -1 -1 -1 -1;
      0  0  0  0  -1 -1 0  0  0  0;
      0  0  0  0  -1 -1 0  0  0  0];
  
HOR = {[5],[1,1],[2,2],[13],[1,1],[1,2,2,1],[2,1,1,2],[5,5],[2,7,2],[1,2,2,1],[1,1],[1,1],[2,2],[1,1,1,1],[13]};
VERT = {[10],[1,3,1,1],[1,1,1,1,2],[2,1,1,1,1],[3,3,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[3,3,1],[2,1,1,1,1],[1,1,1,1,2],[1,3,1,1],[10]};
M_sol = [ -1 -1 -1 -1 -1  1  1  1  1  1 -1 -1 -1 -1 -1;
                 -1 -1 -1 -1  1 -1 -1 -1 -1 -1  1 -1 -1 -1 -1;
                 -1 -1 -1  1  1 -1 -1 -1 -1 -1  1  1 -1 -1 -1;
                 -1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1 -1  1  1 -1 -1 -1 -1 -1 -1 -1  1  1 -1  1;
                  1  1 -1 -1  1 -1 -1 -1 -1 -1  1 -1 -1  1  1;
                  1  1  1  1  1 -1 -1 -1 -1 -1  1  1  1  1  1;
                  1  1 -1 -1  1  1  1  1  1  1  1 -1 -1  1  1;
                  1 -1  1  1 -1 -1 -1 -1 -1 -1 -1  1  1 -1  1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1  1;
                  1 -1  1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1 -1  1;
                 -1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1];

% 30x30
HOR = {[1,6],[2,1,8],[1,1,8],[2,1,9],[6,1,11],[1,5,1,4,1],[2,9,3,3],[12,8],[9,1,1,3],[7,2,1,1],[7,6,1,2],[1,1,1,11,1],[5,6,3,1,3],[6,7,1,2,1],[6,1,7,5,1],[7,8,5,2],[1,3,18],[1,1,2,4,10],[1,2,2,2,4,5],[2,3,2,4],[3,8,3],[3,6],[5,2,1],[3,1,2,2],[8,7,11],[5],[4,7,8],[7,7,7],[1,1,2],[8,9,10]};
VERT = {[2,1,2,1,1,1],[1,2,7,1,1],[1,6,5,2,1],[1,1,7,1,3,2,1],[1,1,3,1,4,2,1,1,1,1],[1,1,2,6,1,1,1,1],[1,1,1,6,2,2,1,1],[4,2,1,1,1,1],[5,6,1,1],[5,2,2,1,1],[5,4,3,4,1],[5,6,2,7],[1,12,1,6,1],[1,13,3,4,1],[1,1,6,6,1,4,1],[1,6,4,1,1,4],[5,3,1,1,2,2,1],[2,3,3,2,6,2],[5,3,2,6,1],[5,2,1,2,5,1],[6,1,3,3,1,1,1],[6,1,1,2,1,1,1],[6,2,4,1,1,1],[5,1,1,5,1,2,1],[4,2,1,7,1,2,1],[3,3,2,5,1,2,1],[2,1,2,6,1,2,1],[3,3,2,1,2,1],[1,2,1,1,1],[4,1,1,1]};
M_sol = [ -1 -1 -1 -1 -1  1  1  1  1  1 -1 -1 -1 -1 -1;
                 -1 -1 -1 -1  1 -1 -1 -1 -1 -1  1 -1 -1 -1 -1;
                 -1 -1 -1  1  1 -1 -1 -1 -1 -1  1  1 -1 -1 -1;
                 -1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1 -1  1  1 -1 -1 -1 -1 -1 -1 -1  1  1 -1  1;
                  1  1 -1 -1  1 -1 -1 -1 -1 -1  1 -1 -1  1  1;
                  1  1  1  1  1 -1 -1 -1 -1 -1  1  1  1  1  1;
                  1  1 -1 -1  1  1  1  1  1  1  1 -1 -1  1  1;
                  1 -1  1  1 -1 -1 -1 -1 -1 -1 -1  1  1 -1  1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1  1;
                  1 -1  1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1 -1  1;
                 -1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1];             
             
% Sys (36x64)
HOR = {[1,7],[9],[11],[8],[5,1],[5,1],[4,1],[5,1],[6,1],[7,1],[7],[7],[8,3,1],[14,9],[27],[28],[29],[18,10],[18,9],[18,6,3],[19,3,3],[18,3,4],[19,1,3],[17,3],[13,3],[14,3],[14,3,3],[14,4,4],[15,4],[15,5],[16,5],[17,6],[18,4],[20,3],[17,2,2,1],[16,1],[16,2],[15,3],[1,2,9,3],[1,9,3],[2,1,6,3],[1,1,7,3],[6,3],[7,3],[7,3],[5,2,4],[2,2,3],[2,2,4],[1,4,4],[1,4,4],[4,4],[1,6,1,2],[1,6,4],[1,1,5,1,2],[1,2,5,1,2],[1,4,1,2],[2,5,1,1],[1,4,1,1],[2,5,1,1],[2,1,5,3],[1,4,3],[2,5,3],[1,5,3],[2,5,4]};
VERT = {[13,1],[19,3],[20,2,4],[24,4],[24,4],[24,1,2],[26,1,1],[32,3,2,1],[32,7],[40,1],[1,41,4],[41,5],[52],[22,32],[4,11,14,12],[4,11,10,12],[4,11,6,11],[4,10,2,8],[4,10,1,6],[4,8,1,2,3],[3,4,1,2,1,1],[3,3,2],[3,4,2],[2,7],[10],[10],[10],[2,7,28],[1,7,22,1,5],[2,6,1,8,27],[2,21,1,9,1],[21,1],[1,13],[1],[],[]};
M_sol = [ -1 -1 -1 -1 -1  1  1  1  1  1 -1 -1 -1 -1 -1;
                 -1 -1 -1 -1  1 -1 -1 -1 -1 -1  1 -1 -1 -1 -1;
                 -1 -1 -1  1  1 -1 -1 -1 -1 -1  1  1 -1 -1 -1;
                 -1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1 -1  1  1 -1 -1 -1 -1 -1 -1 -1  1  1 -1  1;
                  1  1 -1 -1  1 -1 -1 -1 -1 -1  1 -1 -1  1  1;
                  1  1  1  1  1 -1 -1 -1 -1 -1  1  1  1  1  1;
                  1  1 -1 -1  1  1  1  1  1  1  1 -1 -1  1  1;
                  1 -1  1  1 -1 -1 -1 -1 -1 -1 -1  1  1 -1  1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1  1;
                  1 -1  1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1 -1  1;
                 -1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1];
             
% Dziadek (71x76)
HOR = {[],[],[],[],[],[],[],[2, ],[10, ],[15, ],[16, ],[18, ],[7, 1, 8, ],[8, 1, 8, ],[8, 2, 8, ],[7, 10, ],[7, 8, ],[6, 2, 6, ],[5, 2, 9, ],[5, 5, 1, 12, ],[5, 17, 2, 2, ],[5, 9, 7, 1, 2, ],[5, 8, 7, 1, 2, ],[5, 5, 6, 1, 2, ],[5, 5, 1, 2, ],[5, 1, 13, ],[2, 1, 13, 2, ],[2, 7, 3, 2, ],[2, 1, 7, 2, 7, 1, ],[3, 2, 12, 1, 3, 3, 3, ],[2, 1, 5, 5, 2, 13, ],[3, 1, 3, 1, 12, 13, ],[5, 6, 4, 11, 1, 13, ],[12, 5, 41, 1, 3, ],[9, 1, 6, 6, 34, 4, ],[9, 7, 4, 28, 4, 5, ],[9, 7, 29, 4, 6, ],[9, 6, 35, 7, ],[10, 17, 13, 17, 5, ],[11, 16, 3, 7, 16, 4, ],[12, 12, 17, 3, ],[12, 1, 10, 12, 4, 2, ],[15, 9, 11, 2, 1, ],[13, 4, 8, 2, 11, 5, ],[13, 4, 6, 4, 13, 7, ],[14, 2, 4, 4, 14, 6, ],[15, 1, 2, 9, 15, 2, ],[16, 2, 26, 2, ],[12, 3, 26, 3, ],[13, 3, 26, 4, ],[14, 3, 26, 3, ],[15, 3, 27, 3, ],[16, 3, 27, 2, ],[18, 1, 4, 27, 2, ],[19, 5, 27, ],[20, 27, ],[21, 28, ],[21, 1, 30, ],[56, ],[56, ],[56, ],[56, ],[56, ],[56, ],[23, 31, ],[23, 30, ],[24, 29, ],[24, 3, 25, ],[24, 3, 25, ],[25, 28, ],[23, 1, 28, ],[23, 1, 28, ],[26, 27, ],[24, 1, 27, ],[26, 26, ],[27, 26, ]}
VERT = {[46, ],[46, ],[45, ],[44, ],[45, ],[43, ],[1, 44, ],[2, 44, ],[2, 45, ],[6, 3, 38, ],[13, 1, 3, 37, ],[14, 2, 3, 36, ],[14, 2, 6, 27, ],[15, 6, 2, 3, 26, ],[10, 7, 2, 3, 25, ],[9, 8, 2, 3, 24, ],[8, 2, 13, 2, 3, 23, ],[7, 3, 2, 9, 2, 3, 23, ],[6, 4, 4, 9, 2, 3, 22, ],[4, 5, 5, 5, 2, 3, 21, ],[4, 5, 6, 6, 1, 20, ],[4, 5, 3, 4, 6, 1, 1, 18, ],[8, 5, 8, 7, 1, 2, 19, ],[5, 2, 4, 8, 7, 1, 2, 6, 4, 4, ],[5, 1, 3, 8, 8, 1, 2, 6, 4, 2, ],[8, 1, 7, 8, 1, 6, 4, ],[9, 3, 7, 8, 1, 8, 1, ],[8, 5, 2, 3, 6, 3, 9, ],[8, 5, 10, 13, ],[8, 5, 11, 25, ],[6, 5, 7, 2, 26, ],[5, 5, 1, 5, 24, 5, ],[11, 5, 32, ],[3, 5, 32, ],[7, 31, ],[7, 30, ],[7, 30, ],[6, 30, ],[6, 29, ],[7, 29, ],[7, 30, ],[7, 31, ],[7, 32, ],[7, 32, ],[7, 34, ],[7, 35, ],[43, ],[5, 36, ],[43, ],[43, ],[2, 43, ],[11, 43, ],[2, 50, ],[2, 51, ],[2, 4, 46, ],[3, 10, 6, 25, ],[3, 10, 5, 12, ],[3, 2, 13, 5, ],[3, 2, 12, 1, ],[3, 3, 12, 3, ],[3, 3, 17, ],[2, 3, 6, 13, ],[3, 2, 4, 3, 8, ],[6, 3, 2, 3, 4, ],[7, 4, 2, 2, 4, ],[3, 2, 3, ],[4, 1, ],[6, ],[8, ],[9, ],[10, ]}
M_sol = [ -1 -1 -1 -1 -1  1  1  1  1  1 -1 -1 -1 -1 -1;
                 -1 -1 -1 -1  1 -1 -1 -1 -1 -1  1 -1 -1 -1 -1;
                 -1 -1 -1  1  1 -1 -1 -1 -1 -1  1  1 -1 -1 -1;
                 -1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1 -1  1  1 -1 -1 -1 -1 -1 -1 -1  1  1 -1  1;
                  1  1 -1 -1  1 -1 -1 -1 -1 -1  1 -1 -1  1  1;
                  1  1  1  1  1 -1 -1 -1 -1 -1  1  1  1  1  1;
                  1  1 -1 -1  1  1  1  1  1  1  1 -1 -1  1  1;
                  1 -1  1  1 -1 -1 -1 -1 -1 -1 -1  1  1 -1  1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1  1;
                  1 -1  1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1 -1  1;
                 -1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1];
             
% Dziadek3 (41x56)
HOR = {[123, ],[123, ],[123, ],[123, ],[123, ],[18, 37, 37, 19, ],[17, 38, 38, 21, ],[15, 1, 3, 2, 29, 1, 3, 2, 29, 1, 3, 2, 14, ],[15, 1, 1, 30, 1, 1, 30, 1, 1, 15, ],[17, 10, 28, 10, 28, 10, 11, ],[27, 37, 37, 10, ],[29, 37, 37, 8, ],[7, 21, 15, 21, 15, 21, 8, ],[7, 22, 15, 22, 15, 22, 8, ],[31, 39, 39, 8, ],[6, 25, 13, 25, 13, 25, 7, ],[6, 25, 13, 25, 13, 25, 7, ],[6, 25, 13, 25, 13, 25, 7, ],[6, 26, 13, 26, 13, 26, 7, ],[6, 26, 12, 26, 12, 26, 6, ],[6, 26, 12, 26, 12, 26, 6, ],[6, 17, 7, 12, 17, 7, 12, 17, 7, 6, ],[6, 6, 2, 6, 12, 6, 2, 6, 12, 6, 2, 6, 6, ],[6, 5, 3, 4, 11, 5, 3, 4, 11, 5, 3, 4, 5, ],[6, 2, 1, 3, 4, 11, 2, 1, 3, 4, 11, 2, 1, 3, 4, 5, ],[6, 4, 15, 12, 4, 15, 12, 4, 15, 6, ],[6, 3, 1, 30, 3, 1, 30, 3, 1, 24, ],[123, ],[123, ],[123, ],[17, 7, 30, 7, 30, 7, 13, ],[16, 8, 28, 8, 28, 8, 12, ],[15, 9, 26, 9, 26, 9, 11, ],[12, 3, 4, 22, 3, 4, 22, 3, 4, 10, ],[11, 3, 27, 3, 27, 3, 16, ],[10, 4, 26, 4, 26, 4, 16, ],[10, 1, 3, 22, 1, 3, 22, 1, 3, 12, ],[11, 4, 27, 4, 27, 4, 16, ],[11, 3, 31, 3, 31, 3, 20, ],[1, 8, 3, 1, 1, 16, 1, 8, 3, 1, 1, 16, 1, 8, 3, 1, 1, 16, ],[18, 15, 18, 15, 18, 15, ],[18, 17, 18, 17, 18, 17, ],[3, 31, 3, 31, 3, 31, ],[34, 1, 34, 1, 34, 1, ],[7, 10, 13, 7, 10, 13, 7, 10, 13, ],[1, 2, 1, 24, 1, 2, 1, 24, 1, 2, 1, 24, ],[1, 1, 2, 4, 19, 1, 1, 2, 4, 19, 1, 1, 2, 4, 19, ],[1, 2, 4, 3, 8, 1, 1, 2, 4, 3, 8, 1, 1, 2, 4, 3, 8, 1, ],[1, 4, 6, 3, 1, 4, 6, 3, 1, 4, 6, 3, ],[2, 4, 5, 6, 2, 4, 5, 6, 2, 4, 5, 6, ],[1, 4, 4, 8, 1, 4, 4, 8, 1, 4, 4, 8, ],[1, 5, 2, 10, 1, 5, 2, 10, 1, 5, 2, 10, ],[1, 7, 11, 1, 7, 11, 1, 7, 11, ],[2, 10, 12, 2, 10, 12, 2, 10, 12, ],[1, 11, 13, 1, 11, 13, 1, 11, 13, ],[1, 12, 13, 1, 12, 13, 1, 12, 13, ]}
VERT = {[39, 5, ],[41, 2, 1, 1, ],[39, 4, 1, 3, ],[39, 4, 1, ],[42, 5, 1, ],[48, 1, ],[15, 18, ],[12, 9, 20, ],[45, ],[46, ],[24, 1, 8, 8, ],[25, 7, 5, ],[24, 6, 1, 7, ],[22, 6, 19, ],[22, 7, 19, ],[7, 13, 5, 21, ],[8, 13, 4, 4, 6, 9, ],[6, 12, 4, 3, 7, 5, ],[5, 13, 4, 1, 2, 9, 4, ],[5, 26, 7, 4, ],[5, 2, 24, 1, 6, 3, ],[5, 2, 13, 11, 1, 6, 3, ],[7, 13, 9, 1, 3, 2, 3, ],[8, 13, 9, 9, 2, ],[21, 8, 9, 1, ],[7, 12, 11, 10, ],[7, 14, 5, 4, 11, ],[10, 12, 5, 4, 14, ],[9, 12, 6, 3, 15, 2, ],[9, 11, 7, 18, 3, ],[10, 19, 17, 4, ],[11, 35, 5, ],[11, 31, 6, ],[15, 24, 7, ],[19, 21, 8, ],[23, 18, 12, ],[42, 8, ],[42, 7, ],[40, 7, ],[39, 1, 6, ],[39, 5, ]}
M_sol = [ -1 -1 -1 -1 -1  1  1  1  1  1 -1 -1 -1 -1 -1;
                 -1 -1 -1 -1  1 -1 -1 -1 -1 -1  1 -1 -1 -1 -1;
                 -1 -1 -1  1  1 -1 -1 -1 -1 -1  1  1 -1 -1 -1;
                 -1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1 -1  1  1 -1 -1 -1 -1 -1 -1 -1  1  1 -1  1;
                  1  1 -1 -1  1 -1 -1 -1 -1 -1  1 -1 -1  1  1;
                  1  1  1  1  1 -1 -1 -1 -1 -1  1  1  1  1  1;
                  1  1 -1 -1  1  1  1  1  1  1  1 -1 -1  1  1;
                  1 -1  1  1 -1 -1 -1 -1 -1 -1 -1  1  1 -1  1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1  1;
                  1 -1  1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1 -1  1;
                 -1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1];
% Dziadek3 (27x37)
HOR = {[27, ],[27, ],[27, ],[12, 12, ],[9, 9, ],[8, 8, ],[11, 5, 7, ],[5, 13, 5, ],[5, 14, 5, ],[20, 5, ],[4, 16, 4, ],[4, 16, 4, ],[4, 17, 4, ],[4, 17, 4, ],[4, 10, 4, 3, ],[4, 3, 1, 2, 3, ],[4, 1, 2, 2, 3, ],[4, 2, 11, 3, ],[27, ],[27, ],[11, 4, 8, ],[10, 5, 7, ],[7, 3, 6, ],[6, 1, 10, ],[7, 1, 8, ],[7, 1, 11, ],[2, 1, 8, ],[6, 4, 11, ],[18, ],[7, 7, ],[1, 1, 4, 6, ],[1, 1, 1, 4, 1, ],[1, 1, 2, 3, ],[1, 2, 1, 5, ],[3, 7, ],[5, 7, ],[7, 8, ]}
VERT = {[26, 3, ],[26, ],[26, 1, ],[26, 1, 2, ],[10, 8, 1, ],[7, 19, ],[16, 6, 5, ],[16, 4, 2, ],[5, 9, 4, 3, ],[4, 9, 4, 5, 6, ],[4, 9, 3, 1, 3, 4, ],[4, 8, 2, 1, 4, 3, ],[3, 9, 3, 4, 2, ],[3, 16, 3, 2, ],[3, 9, 6, 4, 1, ],[4, 8, 5, 2, 1, ],[4, 8, 5, 1, 2, ],[4, 7, 3, 3, 1, 3, ],[5, 8, 3, 2, 7, ],[6, 7, 4, 12, 1, ],[7, 12, 10, 3, ],[7, 20, 4, ],[10, 14, 5, ],[14, 19, ],[28, 5, ],[27, 4, ],[26, 3, ]}
M_sol = [ -1 -1 -1 -1 -1  1  1  1  1  1 -1 -1 -1 -1 -1;
                 -1 -1 -1 -1  1 -1 -1 -1 -1 -1  1 -1 -1 -1 -1;
                 -1 -1 -1  1  1 -1 -1 -1 -1 -1  1  1 -1 -1 -1;
                 -1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1 -1  1  1 -1 -1 -1 -1 -1 -1 -1  1  1 -1  1;
                  1  1 -1 -1  1 -1 -1 -1 -1 -1  1 -1 -1  1  1;
                  1  1  1  1  1 -1 -1 -1 -1 -1  1  1  1  1  1;
                  1  1 -1 -1  1  1  1  1  1  1  1 -1 -1  1  1;
                  1 -1  1  1 -1 -1 -1 -1 -1 -1 -1  1  1 -1  1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1  1;
                  1 -1  1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1 -1  1;
                 -1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1];
             
             % Internety (27x37)
VERT = {[6,1,2,1,4,7],[1,1,2,1,2,2,3,7],[1,1,2,1,5,2,1,5,7],[1,1,2,1,2,3,1,7,7],[6,6,2,1,10,16],[1,3,1,5,1,17,3],[2,2,2,4,3,3,1],[5,2,2,5,4,3,1],[1,3,1,2,4,9,2,1],[3,1,1,2,6,9,5,11,1],[3,2,1,1,2,1,7,5,3,2,1],[7,2,1,1,1,1,2,1,17,1,1],[1,1,1,2,1,1,1,1,1,1,14,3],[1,1,2,3,1,1,1,18,10,3],[1,2,1,2,2,3,1,15,7,2,3],[1,1,1,2,1,8,21,1,3],[1,1,1,2,2,10,10,7,1,3],[1,1,3,2,6,2,1,8,7,5],[1,1,4,2,4,3,1,6,7,4],[1,5,2,1,4,4,7,4],[1,5,3,4,7,3],[1,5,3,1,1,7,3],[1,6,2,2,1,1,1,7,2],[7,1,2,1,1,1,7,2],[7,3,2,1,4,1,1,1,7,2],[8,8,2,3,2,1,1,1,7,1],[8,12,2,2,3,1,1,7,1],[9,12,1,1,4,15],[9,5,5,7,3,6],[10,4,1,2,9,3,3],[11,4,1,1,2,3,3,10,3],[11,4,1,2,1,2,3,1,18,2,3],[12,3,3,2,5,1,1,7,2,3],[12,12,3,3,2,3,1,7,6],[12,24,4,7,5],[14,2,8,3,2,11,5],[14,1,1,7,3,2,5,4],[15,1,2,2,4,2,3,1,4],[15,1,2,4,1,4,10,2,3],[15,1,2,1,6,9,1,3],[16,6,2,2,1,1,1,7,2,2,2],[13,1,2,2,3,2,1,1,1,7,5,2],[12,1,3,3,1,2,1,1,1,7,4,1],[11,1,5,5,1,1,1,1,1,7,3,1],[10,1,1,6,1,1,1,1,1,1,7,4,1],[9,2,1,4,1,1,1,1,1,1,15,1],[8,1,1,5,1,3,1,1,1,5,6],[7,1,1,6,1,1,1,1,2,5],[6,1,5,5,1,1,4,4],[5,2,3,3,7,1,3,4],[4,1,2,2,4,6,1,2],[3,1,6,3,3,2,1,2],[2,1,2,2,1,1],[1,1,1,1,2,1,1],[1,1,1,1,7,2],[1,25,1,9,2,2],[1,25,1,1,12,1,2],[1,1,1,2,1,1,2,2,1,3],[1,1,2,1,1,1,1,1,10],[2,1,1,7,2,1,1,1,2,2,1,7],[3,1,3,9,4,1,4,4,1,6],[4,1,3,11,9,1,2,6],[5,2,12,3,6,6,6],[6,12,2,8,7],[7,15,6,27],[8,15,4,27],[9,9,32],[10,6,2,2,2,24],[11,5,2,3,2,23],[12,4,1,4,1,22],[13,3,2,1,1,3,2,21],[15,2,2,1,4,1,21],[14,2,3,1,4,1,21],[14,2,1,1,1,4,1,21],[14,2,6,1,1,4,1,21],[14,3,2,5,1,4,1,21],[13,3,2,1,4,1,21],[12,5,2,1,1,3,2,22],[12,3,1,1,4,1,22],[12,3,2,3,2,24],[11,4,2,31],[1,11,4,33],[1,10,8,4,5,27],[1,9,13,4,9,7],[1,9,12,1,7,3,6],[1,8,2,15,4,4,5],[1,8,1,1,12,2,9],[1,1,7,2,10,6,1,6,8],[1,1,7,4,1,13,2],[1,1,6,4,1,3,2],[1,1,5,4,2,2,16],[1,1,1,5,4,1,2,3],[1,1,1,5,4,1,2,1,1,2],[1,1,1,4,4,5,2,1,1],[1,1,1,3,1,4,1,4,1],[1,1,1,2,7,2,1,2],[1,1,1,2,1,5,4,3],[1,1,1,1,4,1,7,4],[1,1,1,1,2,3,5,6],[1,1,1,1,7,11]}
HOR = {[12,35,19],[1,18,17],[1,20,20,13],[4,22,22],[1,5,23,23,9],[2,24,24],[4,25,25],[2,4,25,25],[3,26,26],[2,2,26,26],[4,2,26,26],[5,1,2,26,26],[1,1,2,1,26,26],[1,1,1,5,11,14,11,5],[1,1,2,2,6,5,2,5,6,3,2],[1,1,1,6,2,7,9],[1,2,26],[2,24,1],[4,6,2,11,3,6],[8,2,2,2,9,2,5],[10,3,3,2,2,6,4],[4,7,13,5,6,2,5,2,2,5],[2,2,4,2,1,6,1,2,6,4,6,5],[7,8,4,1,1,3,1,4,1,2,6,2,2,2,5],[6,2,2,4,5,1,4,1,2,7,1,1,1,5],[2,2,6,2,4,1,1,3,2,1,6,1,2,7,1,1,1,6],[5,2,2,3,2,3,3,4,5,5,2,4,2,2,2,3],[1,1,1,4,2,4,6,3,3,2,4,2,2,1,4],[3,2,1,1,4,1,14,2,2,2,3,2,2,1,1,4],[2,3,4,1,4,5,2,6,2,3,1,1,4],[1,5,9,5,5,2,2,3,4,4],[1,6,1,4,2,4,1,3,1,4,2,3,1,1,3],[1,4,2,3,2,1,1,1,3,2,1,2,4,13,4],[2,4,1,1,1,1,1,4,2,7,3,3,2,2],[3,6,1,1,4,3,2,3,2,2,2,1,12,2],[2,2,2,2,1,11,2,2,2,2,2,10,1,3,3],[2,2,2,2,2,2,10,2,2,5,1,2,8,1,1,1,1,1],[2,9,1,1,2,1,1,5,2,6,1,6,2,1,1,1,1],[1,10,2,2,2,1,2,2,2,2,1,1,2,2,1],[1,10,1,2,3,2,1,1,2,2,1,1,1,1],[2,9,1,2,1,1,2,1,7,3,3,2,1,1,2],[4,12,1,1,2,1,1,1,3,5,1,3,4],[2,8,1,10,1,1,1,8,2,1,1,1,3],[2,8,2,7,2,2,6,3,6,1,1,2,1],[3,8,8,1,1,7,9,4,2],[3,10,1,2,2,2,8,7,3,1,1,1],[4,18,3,14,13,7,2,2,2,2],[7,12,1,1,2,2,2,3,7,6,2,7,2],[20,6,4,13,2,8,8,2,1,2,1],[20,1,1,2,1,1,2,23,2,2,1],[4,2,3,7,5,11,2,21,2,2,2],[1,1,1,1,1,1,2,1,2,21,3,1,2],[1,1,1,1,1,1,1,1,2,19,3,1,2],[6,1,14,6,11,2,19,6,2],[6,1,14,6,10,3,3,19,2,3],[6,1,15,6,9,1,1,1,1,19,1,2],[6,2,15,6,9,1,1,1,1,19,1,1,3],[6,1,15,6,9,1,2,2,1,19,1,1,2],[6,1,15,6,8,1,3,1,19,2,1,2],[5,1,15,7,8,3,2,19,1,1,2],[1,1,1,1,1,1,2,1,10,19,1,1,2],[1,1,1,2,1,1,2,1,2,1,19,2,1,1],[1,1,1,1,2,1,2,1,1,2,19,2,1,1],[1,1,1,1,2,3,2,1,4,21,2,1,1],[1,1,2,1,2,9,30,3,1,2],[1,1,4,3,3,8,2,33,2],[1,2,3,10,14,30,3,3],[2,12,11,6,30,2,4],[2,13,11,6,30,2,5],[22,21,30,8]}
M_sol = [ -1 -1 -1 -1 -1  1  1  1  1  1 -1 -1 -1 -1 -1;
                 -1 -1 -1 -1  1 -1 -1 -1 -1 -1  1 -1 -1 -1 -1;
                 -1 -1 -1  1  1 -1 -1 -1 -1 -1  1  1 -1 -1 -1;
                 -1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1 -1  1  1 -1 -1 -1 -1 -1 -1 -1  1  1 -1  1;
                  1  1 -1 -1  1 -1 -1 -1 -1 -1  1 -1 -1  1  1;
                  1  1  1  1  1 -1 -1 -1 -1 -1  1  1  1  1  1;
                  1  1 -1 -1  1  1  1  1  1  1  1 -1 -1  1  1;
                  1 -1  1  1 -1 -1 -1 -1 -1 -1 -1  1  1 -1  1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1;
                  1  1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1  1;
                  1 -1  1 -1 -1 -1 -1 -1 -1 -1 -1 -1  1 -1  1;
                 -1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1];
             
M = zeros(70,100);

% Zero - no idea
% One  - hit
% -One - empty

spd = 0.01;

visualize(M,VERT,HOR,0);
pause(spd)

%% Start solving
M_last = [];
iter = 0;
while ~isequal(M, M_last)
    M_last = M;
    %% Rows
    for i = 1:size(M,1)
        iter = iter + 1;
        M(i,:) = przeanalizuj5(M(i,:),HOR{i});
        visualize(M,VERT,HOR,iter);
        pause(spd)
    end
visualize(M,VERT,HOR,iter);
    %% Columns
    for i = 1:size(M,2)
        iter = iter + 1;
        M(:,i) = przeanalizuj5(M(:,i)',VERT{i})';
        visualize(M,VERT,HOR,iter);
        pause(spd)
    end
    visualize(M,VERT,HOR,iter);
end